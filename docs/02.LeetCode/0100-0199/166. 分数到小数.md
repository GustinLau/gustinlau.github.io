---
id: 912FE39902F97B3F
title: 166、分数到小数
date: 2022-04-22 15:40:35
permalink: /leetcode/fraction-to-recurring-decimal
link: https://leetcode-cn.com/problems/fraction-to-recurring-decimal
toc: false
categories:
  - LeetCode
tags:
  - 哈希表
  - 数学
  - 字符串
---

<Level type='medium'/>

## 题目

给定两个整数，分别表示分数的分子`numerator` 和分母`denominator`，以 **字符串形式返回小数** 。

如果小数部分为循环小数，则将循环的部分括在括号内。

如果存在多个答案，只需返回**任意一个**。

对于所有给定的输入，**保证**答案字符串的长度小于 <code>10<sup>4</sup></code> 。

## 示例

示例 1：

```text
输入：numerator = 1, denominator = 2
输出："0.5"
```

示例 2：

```text
输入：numerator = 2, denominator = 1
输出："2"
```

示例 3：

```text
输入：numerator = 2, denominator = 3
输出："0.(6)"
```

示例 4：

```text
输入：numerator = 4, denominator = 333
输出："0.(012)"
```

示例 5：

```text
输入：numerator = 1, denominator = 5
输出："0.2"
```

## 提示

- -2<sup>31</sup> <=numerator, denominator <= 2<sup>31</sup> - 1
- denominator != 0

## 分析

该题细节较多

1. 判断两数相除是否含有小数，没有小数直接两数相除返回（注意浮点计算问题）。
2. 判断两数相除结果是否带“-”号。
3. 结果为负数向下取整与结果为正数向下取整不一样，应该将两数先都转为正数再计算。
4. 创建一个 map 记录余数出现的下标，余数\*10 后再除以分母，获得小数位，再计算下一位余数。
5. 余数为 0 表示不是循环小数，出现过余数记录则表示是循环小数。
6. 循环小数开始下标是记录该余数时的下标。
7. 组装结果返回即可。

## 解答

```javascript
/**
 * @param {number} numerator
 * @param {number} denominator
 * @return {string}
 */
var fractionToDecimal = function (numerator, denominator) {
  if (numerator % denominator === 0) {
    return '' + Math.floor(numerator / denominator)
  }
  const remainderIndexMap = new Map()
  const fractionPath = []
  const integerPart = []
  if ((numerator < 0) ^ (denominator < 0)) {
    integerPart.push('-')
  }
  numerator = Math.abs(numerator)
  denominator = Math.abs(denominator)
  integerPart.push(Math.floor(numerator / denominator))
  let remainder = numerator % denominator
  let index = 0
  while (remainder !== 0 && !remainderIndexMap.has(remainder)) {
    remainderIndexMap.set(remainder, index++)
    remainder *= 10
    fractionPath.push(Math.floor(remainder / denominator))
    remainder = remainder % denominator
  }
  if (remainder !== 0) {
    fractionPath.splice(remainderIndexMap.get(remainder), 0, '(')
    fractionPath.push(')')
  }
  if (fractionPath.length > 0) {
    return integerPart.join('') + '.' + fractionPath.join('')
  }
  return integerPart.join('')
}
```
