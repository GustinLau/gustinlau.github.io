<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>qiankun微应用加载的资源404问题记录 | 星星杂货铺</title>
  <meta name="generator" content="VuePress 1.9.5">
  <link rel="icon" href="/favicon.ico">
  <meta name="description" content="我的个人博客，这里主要用来放一些自己的文件，自己爬过的坑以及学习过程中的一些知识的记录。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    <meta property="og:image" content="/img/star.png">
    <meta property="og:description" content="🎉欢迎来到我的博客🎉">
  
  <link rel="preload" href="/assets/css/0.styles.15b58bb0.css" as="style"><link rel="preload" href="/assets/js/app.5600cbc3.js" as="script"><link rel="preload" href="/assets/js/2.e08c09ee.js" as="script"><link rel="preload" href="/assets/js/3.b14da0d3.js" as="script"><link rel="preload" href="/assets/js/10.4bfb545f.js" as="script"><link rel="prefetch" href="/assets/js/100.f3195758.js"><link rel="prefetch" href="/assets/js/101.1a277e3d.js"><link rel="prefetch" href="/assets/js/102.6f40ee3a.js"><link rel="prefetch" href="/assets/js/103.5b2c1d30.js"><link rel="prefetch" href="/assets/js/104.063f79df.js"><link rel="prefetch" href="/assets/js/105.682303dd.js"><link rel="prefetch" href="/assets/js/106.b17e2cf0.js"><link rel="prefetch" href="/assets/js/107.086a1cc6.js"><link rel="prefetch" href="/assets/js/108.2329188e.js"><link rel="prefetch" href="/assets/js/109.9789e319.js"><link rel="prefetch" href="/assets/js/11.e4942a0d.js"><link rel="prefetch" href="/assets/js/110.6e878a7e.js"><link rel="prefetch" href="/assets/js/111.11cfb49b.js"><link rel="prefetch" href="/assets/js/112.35d5b77f.js"><link rel="prefetch" href="/assets/js/113.c06680d8.js"><link rel="prefetch" href="/assets/js/114.832148b6.js"><link rel="prefetch" href="/assets/js/115.9a02a5e2.js"><link rel="prefetch" href="/assets/js/116.a5615e4b.js"><link rel="prefetch" href="/assets/js/117.b6bbdea6.js"><link rel="prefetch" href="/assets/js/118.e88a709c.js"><link rel="prefetch" href="/assets/js/119.a98e2674.js"><link rel="prefetch" href="/assets/js/12.19010bef.js"><link rel="prefetch" href="/assets/js/120.c1f70eb2.js"><link rel="prefetch" href="/assets/js/121.c419c1eb.js"><link rel="prefetch" href="/assets/js/122.f53ea94b.js"><link rel="prefetch" href="/assets/js/123.6c5d871e.js"><link rel="prefetch" href="/assets/js/124.748ba712.js"><link rel="prefetch" href="/assets/js/125.835c14b7.js"><link rel="prefetch" href="/assets/js/126.a8372495.js"><link rel="prefetch" href="/assets/js/127.239eb70f.js"><link rel="prefetch" href="/assets/js/128.d56ce121.js"><link rel="prefetch" href="/assets/js/129.a4c88439.js"><link rel="prefetch" href="/assets/js/13.41c89f4b.js"><link rel="prefetch" href="/assets/js/130.c9d7b989.js"><link rel="prefetch" href="/assets/js/131.5fbaa90d.js"><link rel="prefetch" href="/assets/js/132.87c8647b.js"><link rel="prefetch" href="/assets/js/133.f3a4c7d2.js"><link rel="prefetch" href="/assets/js/134.8b74d58e.js"><link rel="prefetch" href="/assets/js/135.1a63533a.js"><link rel="prefetch" href="/assets/js/136.7331aa8e.js"><link rel="prefetch" href="/assets/js/137.49553bad.js"><link rel="prefetch" href="/assets/js/138.f981d233.js"><link rel="prefetch" href="/assets/js/139.ebcdd497.js"><link rel="prefetch" href="/assets/js/14.d44c4622.js"><link rel="prefetch" href="/assets/js/140.e521f3e0.js"><link rel="prefetch" href="/assets/js/141.d0c1681a.js"><link rel="prefetch" href="/assets/js/142.aa622b50.js"><link rel="prefetch" href="/assets/js/143.7b9554af.js"><link rel="prefetch" href="/assets/js/144.58ef8774.js"><link rel="prefetch" href="/assets/js/145.41b66053.js"><link rel="prefetch" href="/assets/js/146.c69b4593.js"><link rel="prefetch" href="/assets/js/147.f2173cc7.js"><link rel="prefetch" href="/assets/js/148.5bd197a8.js"><link rel="prefetch" href="/assets/js/149.9b058dfb.js"><link rel="prefetch" href="/assets/js/15.8c3da039.js"><link rel="prefetch" href="/assets/js/150.037ac425.js"><link rel="prefetch" href="/assets/js/151.2ddc8307.js"><link rel="prefetch" href="/assets/js/152.bdb36ab3.js"><link rel="prefetch" href="/assets/js/153.dd3de955.js"><link rel="prefetch" href="/assets/js/154.3e94d5f2.js"><link rel="prefetch" href="/assets/js/155.77d15322.js"><link rel="prefetch" href="/assets/js/156.141a105a.js"><link rel="prefetch" href="/assets/js/157.546afe0d.js"><link rel="prefetch" href="/assets/js/158.3bf24a1b.js"><link rel="prefetch" href="/assets/js/159.b23f050e.js"><link rel="prefetch" href="/assets/js/16.70fa3fe9.js"><link rel="prefetch" href="/assets/js/160.8351e689.js"><link rel="prefetch" href="/assets/js/161.44624dda.js"><link rel="prefetch" href="/assets/js/162.b4f85e71.js"><link rel="prefetch" href="/assets/js/163.b7ed0c26.js"><link rel="prefetch" href="/assets/js/164.30108bd2.js"><link rel="prefetch" href="/assets/js/165.cc8767bb.js"><link rel="prefetch" href="/assets/js/166.7a336e42.js"><link rel="prefetch" href="/assets/js/167.9fc3e577.js"><link rel="prefetch" href="/assets/js/168.658acca9.js"><link rel="prefetch" href="/assets/js/169.0860e2ba.js"><link rel="prefetch" href="/assets/js/17.ccdbbf8e.js"><link rel="prefetch" href="/assets/js/170.4273fce7.js"><link rel="prefetch" href="/assets/js/171.f3683937.js"><link rel="prefetch" href="/assets/js/172.4a06f020.js"><link rel="prefetch" href="/assets/js/173.c758a5c0.js"><link rel="prefetch" href="/assets/js/174.1997d920.js"><link rel="prefetch" href="/assets/js/175.aa978d0b.js"><link rel="prefetch" href="/assets/js/176.7d288a1a.js"><link rel="prefetch" href="/assets/js/177.5817f73e.js"><link rel="prefetch" href="/assets/js/178.88e24716.js"><link rel="prefetch" href="/assets/js/179.67848896.js"><link rel="prefetch" href="/assets/js/18.b2168064.js"><link rel="prefetch" href="/assets/js/180.8092b91b.js"><link rel="prefetch" href="/assets/js/181.0beef3ef.js"><link rel="prefetch" href="/assets/js/182.ca5ff12a.js"><link rel="prefetch" href="/assets/js/183.d20f9177.js"><link rel="prefetch" href="/assets/js/184.d887a9e5.js"><link rel="prefetch" href="/assets/js/185.f53c0a7b.js"><link rel="prefetch" href="/assets/js/186.8831a4aa.js"><link rel="prefetch" href="/assets/js/187.6cd59a81.js"><link rel="prefetch" href="/assets/js/188.218929fd.js"><link rel="prefetch" href="/assets/js/189.ddb46e4e.js"><link rel="prefetch" href="/assets/js/19.fbb6ca7d.js"><link rel="prefetch" href="/assets/js/190.040e0f98.js"><link rel="prefetch" href="/assets/js/191.b7b3e5f3.js"><link rel="prefetch" href="/assets/js/192.cedd0498.js"><link rel="prefetch" href="/assets/js/193.fe77a1c4.js"><link rel="prefetch" href="/assets/js/194.9380a755.js"><link rel="prefetch" href="/assets/js/195.2ad02d55.js"><link rel="prefetch" href="/assets/js/196.800424c0.js"><link rel="prefetch" href="/assets/js/197.1a1f4bd8.js"><link rel="prefetch" href="/assets/js/198.7e2ccfc7.js"><link rel="prefetch" href="/assets/js/199.67a42f17.js"><link rel="prefetch" href="/assets/js/20.1d717dc7.js"><link rel="prefetch" href="/assets/js/200.7edcd454.js"><link rel="prefetch" href="/assets/js/201.3ad05fad.js"><link rel="prefetch" href="/assets/js/202.36f7de39.js"><link rel="prefetch" href="/assets/js/203.d61b06b0.js"><link rel="prefetch" href="/assets/js/204.84ba0b1c.js"><link rel="prefetch" href="/assets/js/205.e4679e3f.js"><link rel="prefetch" href="/assets/js/206.221ffbce.js"><link rel="prefetch" href="/assets/js/207.090e4433.js"><link rel="prefetch" href="/assets/js/208.4a5cc836.js"><link rel="prefetch" href="/assets/js/209.be254791.js"><link rel="prefetch" href="/assets/js/21.b19d5cc4.js"><link rel="prefetch" href="/assets/js/210.11e610e3.js"><link rel="prefetch" href="/assets/js/211.44482538.js"><link rel="prefetch" href="/assets/js/212.f5049a67.js"><link rel="prefetch" href="/assets/js/213.42b27885.js"><link rel="prefetch" href="/assets/js/214.23f7eadd.js"><link rel="prefetch" href="/assets/js/215.285350fa.js"><link rel="prefetch" href="/assets/js/216.8a118875.js"><link rel="prefetch" href="/assets/js/217.625fea8f.js"><link rel="prefetch" href="/assets/js/218.5599fa29.js"><link rel="prefetch" href="/assets/js/219.c1cd1e40.js"><link rel="prefetch" href="/assets/js/22.f0b46dae.js"><link rel="prefetch" href="/assets/js/220.549a796c.js"><link rel="prefetch" href="/assets/js/221.c0939232.js"><link rel="prefetch" href="/assets/js/222.ec2b210c.js"><link rel="prefetch" href="/assets/js/223.9373ef5d.js"><link rel="prefetch" href="/assets/js/224.58d3154e.js"><link rel="prefetch" href="/assets/js/225.052c60da.js"><link rel="prefetch" href="/assets/js/226.08b17dc7.js"><link rel="prefetch" href="/assets/js/227.bf99c8ca.js"><link rel="prefetch" href="/assets/js/228.7df906b3.js"><link rel="prefetch" href="/assets/js/229.b7c56bd4.js"><link rel="prefetch" href="/assets/js/23.5021bdea.js"><link rel="prefetch" href="/assets/js/230.a0e7cddc.js"><link rel="prefetch" href="/assets/js/231.f393cdf6.js"><link rel="prefetch" href="/assets/js/232.8fe6b61a.js"><link rel="prefetch" href="/assets/js/233.1063c9d0.js"><link rel="prefetch" href="/assets/js/234.46797913.js"><link rel="prefetch" href="/assets/js/235.6dab6024.js"><link rel="prefetch" href="/assets/js/236.59c6a6ad.js"><link rel="prefetch" href="/assets/js/237.9a12f266.js"><link rel="prefetch" href="/assets/js/238.10956766.js"><link rel="prefetch" href="/assets/js/239.a6d75c47.js"><link rel="prefetch" href="/assets/js/24.3b60017c.js"><link rel="prefetch" href="/assets/js/240.c77aeb26.js"><link rel="prefetch" href="/assets/js/241.c8b5b1b0.js"><link rel="prefetch" href="/assets/js/242.2fd55503.js"><link rel="prefetch" href="/assets/js/243.831c7d0d.js"><link rel="prefetch" href="/assets/js/244.97bc5861.js"><link rel="prefetch" href="/assets/js/245.ae9943e7.js"><link rel="prefetch" href="/assets/js/246.ecb5ced4.js"><link rel="prefetch" href="/assets/js/247.306d4c2d.js"><link rel="prefetch" href="/assets/js/248.46d78c62.js"><link rel="prefetch" href="/assets/js/249.98af99f5.js"><link rel="prefetch" href="/assets/js/25.92f92bf7.js"><link rel="prefetch" href="/assets/js/250.23191694.js"><link rel="prefetch" href="/assets/js/251.da4b286b.js"><link rel="prefetch" href="/assets/js/252.b581bcd6.js"><link rel="prefetch" href="/assets/js/253.c99b4b38.js"><link rel="prefetch" href="/assets/js/254.42f2a250.js"><link rel="prefetch" href="/assets/js/255.07465bcf.js"><link rel="prefetch" href="/assets/js/256.3ca1a4f3.js"><link rel="prefetch" href="/assets/js/257.11cd99c5.js"><link rel="prefetch" href="/assets/js/258.97be33b0.js"><link rel="prefetch" href="/assets/js/259.4ed908c6.js"><link rel="prefetch" href="/assets/js/26.258c0d0b.js"><link rel="prefetch" href="/assets/js/260.d2b9d272.js"><link rel="prefetch" href="/assets/js/261.26735122.js"><link rel="prefetch" href="/assets/js/262.e07982a8.js"><link rel="prefetch" href="/assets/js/263.66e599ee.js"><link rel="prefetch" href="/assets/js/264.a4e28fcd.js"><link rel="prefetch" href="/assets/js/265.5f068ab9.js"><link rel="prefetch" href="/assets/js/266.f83c7e94.js"><link rel="prefetch" href="/assets/js/267.7454d08d.js"><link rel="prefetch" href="/assets/js/268.ea8f0775.js"><link rel="prefetch" href="/assets/js/269.9029441e.js"><link rel="prefetch" href="/assets/js/27.6034cf7c.js"><link rel="prefetch" href="/assets/js/270.c99d50fc.js"><link rel="prefetch" href="/assets/js/271.d8a59204.js"><link rel="prefetch" href="/assets/js/272.063867a5.js"><link rel="prefetch" href="/assets/js/273.06717d22.js"><link rel="prefetch" href="/assets/js/274.4ec32c4e.js"><link rel="prefetch" href="/assets/js/28.7d01b245.js"><link rel="prefetch" href="/assets/js/29.9bc9a94d.js"><link rel="prefetch" href="/assets/js/30.e4d867c3.js"><link rel="prefetch" href="/assets/js/31.9022060a.js"><link rel="prefetch" href="/assets/js/32.d79016ae.js"><link rel="prefetch" href="/assets/js/33.fcf3bb93.js"><link rel="prefetch" href="/assets/js/34.cef62233.js"><link rel="prefetch" href="/assets/js/35.1f85d95a.js"><link rel="prefetch" href="/assets/js/36.e3f7ba5d.js"><link rel="prefetch" href="/assets/js/37.f27f1ba4.js"><link rel="prefetch" href="/assets/js/38.378db67d.js"><link rel="prefetch" href="/assets/js/39.16c4a8b9.js"><link rel="prefetch" href="/assets/js/4.a303d055.js"><link rel="prefetch" href="/assets/js/40.37dd4de5.js"><link rel="prefetch" href="/assets/js/41.804c4bf0.js"><link rel="prefetch" href="/assets/js/42.e0966ff0.js"><link rel="prefetch" href="/assets/js/43.d8ce7073.js"><link rel="prefetch" href="/assets/js/44.e7319fd6.js"><link rel="prefetch" href="/assets/js/45.3aaf69fc.js"><link rel="prefetch" href="/assets/js/46.299bd554.js"><link rel="prefetch" href="/assets/js/47.12c6c76d.js"><link rel="prefetch" href="/assets/js/48.6aeb0226.js"><link rel="prefetch" href="/assets/js/49.50f3a9da.js"><link rel="prefetch" href="/assets/js/5.9d538872.js"><link rel="prefetch" href="/assets/js/50.5795384d.js"><link rel="prefetch" href="/assets/js/51.58a83091.js"><link rel="prefetch" href="/assets/js/52.573ff932.js"><link rel="prefetch" href="/assets/js/53.742ba343.js"><link rel="prefetch" href="/assets/js/54.56908346.js"><link rel="prefetch" href="/assets/js/55.c43111dc.js"><link rel="prefetch" href="/assets/js/56.6c9933d8.js"><link rel="prefetch" href="/assets/js/57.259875dd.js"><link rel="prefetch" href="/assets/js/58.bac8eb7c.js"><link rel="prefetch" href="/assets/js/59.e789539c.js"><link rel="prefetch" href="/assets/js/6.e00bfd66.js"><link rel="prefetch" href="/assets/js/60.faf36146.js"><link rel="prefetch" href="/assets/js/61.a95a0f64.js"><link rel="prefetch" href="/assets/js/62.a819709d.js"><link rel="prefetch" href="/assets/js/63.d6e52a49.js"><link rel="prefetch" href="/assets/js/64.655d1628.js"><link rel="prefetch" href="/assets/js/65.9a02a503.js"><link rel="prefetch" href="/assets/js/66.34c0298d.js"><link rel="prefetch" href="/assets/js/67.63f37575.js"><link rel="prefetch" href="/assets/js/68.af069528.js"><link rel="prefetch" href="/assets/js/69.8e58db2b.js"><link rel="prefetch" href="/assets/js/7.84314baa.js"><link rel="prefetch" href="/assets/js/70.c074926d.js"><link rel="prefetch" href="/assets/js/71.37ffbadc.js"><link rel="prefetch" href="/assets/js/72.f95a0407.js"><link rel="prefetch" href="/assets/js/73.07d943b3.js"><link rel="prefetch" href="/assets/js/74.cfc496e1.js"><link rel="prefetch" href="/assets/js/75.a93b1416.js"><link rel="prefetch" href="/assets/js/76.bb5f6260.js"><link rel="prefetch" href="/assets/js/77.f16d6078.js"><link rel="prefetch" href="/assets/js/78.b1344bdb.js"><link rel="prefetch" href="/assets/js/79.6de72a79.js"><link rel="prefetch" href="/assets/js/8.63b49794.js"><link rel="prefetch" href="/assets/js/80.f5bcb06c.js"><link rel="prefetch" href="/assets/js/81.e304074f.js"><link rel="prefetch" href="/assets/js/82.33e79faf.js"><link rel="prefetch" href="/assets/js/83.ab10af78.js"><link rel="prefetch" href="/assets/js/84.08420597.js"><link rel="prefetch" href="/assets/js/85.10951a3a.js"><link rel="prefetch" href="/assets/js/86.b832a8d6.js"><link rel="prefetch" href="/assets/js/87.e9d73c24.js"><link rel="prefetch" href="/assets/js/88.ac6f7970.js"><link rel="prefetch" href="/assets/js/89.68dde510.js"><link rel="prefetch" href="/assets/js/9.267b501b.js"><link rel="prefetch" href="/assets/js/90.9ecf0851.js"><link rel="prefetch" href="/assets/js/91.4400666d.js"><link rel="prefetch" href="/assets/js/92.91404e6e.js"><link rel="prefetch" href="/assets/js/93.ee85e30a.js"><link rel="prefetch" href="/assets/js/94.e065022c.js"><link rel="prefetch" href="/assets/js/95.894879fd.js"><link rel="prefetch" href="/assets/js/96.526e905b.js"><link rel="prefetch" href="/assets/js/97.aec55a33.js"><link rel="prefetch" href="/assets/js/98.5d6b4736.js"><link rel="prefetch" href="/assets/js/99.dd6cbfa7.js">
  <link rel="stylesheet" href="/assets/css/0.styles.15b58bb0.css">
</head>
<body class="theme-mode-light">
<div id="app" data-server-rendered="true"><div class="theme-container have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/svg/star.svg" alt="星星杂货铺" class="logo"> <span class="site-name can-hide">星星杂货铺</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link" data-v-71c313e0>
  首页
</a></div><div class="nav-item"><a href="/web/" class="nav-link router-link-active" data-v-71c313e0>
  前端
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link" data-v-71c313e0>
  算法
</a></div><div class="nav-item"><a href="/technology/" class="nav-link" data-v-71c313e0>
  技术
</a></div><div class="nav-item"><a href="/about/" class="nav-link" data-v-71c313e0>
  关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">
      索引
    </a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link" data-v-71c313e0>
  分类
</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link" data-v-71c313e0>
  标签
</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link" data-v-71c313e0>
  归档
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.jpg"> <div class="blogger-info"><h3>Gustin Lau</h3> <span>知行合一</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link" data-v-71c313e0>
  首页
</a></div><div class="nav-item"><a href="/web/" class="nav-link router-link-active" data-v-71c313e0>
  前端
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link" data-v-71c313e0>
  算法
</a></div><div class="nav-item"><a href="/technology/" class="nav-link" data-v-71c313e0>
  技术
</a></div><div class="nav-item"><a href="/about/" class="nav-link" data-v-71c313e0>
  关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">
      索引
    </a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link" data-v-71c313e0>
  分类
</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link" data-v-71c313e0>
  标签
</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link" data-v-71c313e0>
  归档
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/web/qiankun-assets-404-issue/" aria-current="page" class="active sidebar-link">qiankun微应用加载的资源404问题记录</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/web/qiankun-assets-404-issue/#问题" class="sidebar-link">问题</a></li><li class="sidebar-sub-header level2"><a href="/web/qiankun-assets-404-issue/#分析" class="sidebar-link">分析</a></li><li class="sidebar-sub-header level2"><a href="/web/qiankun-assets-404-issue/#解决方案" class="sidebar-link">解决方案</a></li></ul></li><li><a href="/web/vue-router-dynamic-base-solution/" class="sidebar-link">Vue路由动态base方案</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-05a28426><div class="articleInfo" data-v-05a28426><ul class="breadcrumbs" data-v-05a28426><li data-v-05a28426><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-05a28426></a></li> <li data-v-05a28426><a href="/web/#前端" data-v-05a28426>
          前端
        </a></li></ul> <div class="info" data-v-05a28426><div title="作者" class="author iconfont icon-touxiang" data-v-05a28426><a href="https://github.com/gustinlau" target="_blank" title="作者" class="beLink" data-v-05a28426>
          Gustin Lau
        </a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-05a28426><a href="javascript:;" data-v-05a28426>2022-04-27</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src=""> <span>
            qiankun微应用加载的资源404问题记录
            <!----></span> <!----></h1> <div class="theme-vdoing-content content__default"><h2 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h2> <p>在项目组使用 <code>qiankun</code> 接入子项目的过程中，出现了这样一个问题：</p> <p>子应用在单独部署时，写在 <code>css</code> 中图标、字体等资源加载是正常的，但是接入 <code>qiankun</code>，之后这些资源加载就 <code>404</code> 了。通过查看这些资源请求 <code>URL</code>，都指向了基座地址，也就是说，子应用在 <code>css</code> 中使用的是相对地址。但是为什么子应用使用相对地址就会出错呢？</p> <h2 id="分析"><a href="#分析" class="header-anchor">#</a> 分析</h2> <p>关于子应用 <code>css</code> 中的字体文件和图片加载 <code>404</code> 问题，官方是这样解释的<sup class="footnote-ref"><a href="#footnote1">[1]</a><a id="footnote-ref1" class="footnote-anchor"></a></sup>：</p> <blockquote><p>原因是 <code>qiankun</code> 将外链样式改成了内联样式，但是字体文件和背景图片的加载路径是相对路径。<br>
而 <code>css</code> 文件一旦打包完成，就无法通过动态修改 <code>publicPath</code> 来修正其中的字体文件和背景图片的路径。</p></blockquote> <p>源码：<sup class="footnote-ref"><a href="#footnote2">[2]</a><a id="footnote-ref2" class="footnote-anchor"></a></sup></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * convert external css link to inline style for performance optimization
 * @param template
 * @param styles
 * @param opts
 * @return embedHTML
 */</span>
<span class="token keyword">function</span> <span class="token function">getEmbedHTML</span><span class="token punctuation">(</span><span class="token parameter">template<span class="token punctuation">,</span> styles<span class="token punctuation">,</span> opts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> fetch <span class="token operator">=</span> defaultFetch <span class="token punctuation">}</span> <span class="token operator">=</span> opts
  <span class="token keyword">let</span> embedHTML <span class="token operator">=</span> template

  <span class="token keyword">return</span> <span class="token function">getExternalStyleSheets</span><span class="token punctuation">(</span>styles<span class="token punctuation">,</span> fetch<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">styleSheets</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    embedHTML <span class="token operator">=</span> styles<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">html<span class="token punctuation">,</span> styleSrc<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      html <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token function">genLinkReplaceSymbol</span><span class="token punctuation">(</span>styleSrc<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;style&gt;/* </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styleSrc<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> */</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styleSheets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/style&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> html
    <span class="token punctuation">}</span><span class="token punctuation">,</span> embedHTML<span class="token punctuation">)</span>
    <span class="token keyword">return</span> embedHTML
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="解决方案"><a href="#解决方案" class="header-anchor">#</a> 解决方案</h2> <p>对于以上问题，<code>qiankun</code> 官方给出了以下解决方案<sup class="footnote-ref"><a href="#footnote1">[1:1]</a><a id="footnote-ref1:1" class="footnote-anchor"></a></sup>：</p> <ol><li>所有图片等静态资源上传至 <code>cdn</code>，<code>css</code> 中直接引用 <code>cdn</code> 地址（<strong>推荐</strong>）</li> <li>借助 <code>webpack</code> 的 url-<code>loader</code> 将字体文件和图片打包成 <code>base64</code>（适用于字体文件和图片体积小的项目）（<strong>推荐</strong>）</li> <li>借助 <code>webpack</code> 的 file-<code>loader</code> ，在打包时给其注入完整路径（适用于字体文件和图片体积比较大的项目）</li> <li>将两种方案结合起来，小文件转 <code>base64</code> ，大文件注入路径前缀</li> <li><code>vue-cli3</code> 项目可以将 <code>css</code> 打包到 <code>js</code> 里面，不单独生成文件(不推荐，仅适用于 css 较少的项目)</li></ol> <p>对应方案的配置就不在此赘述了，可以看出，官方给出的方案，都是依靠子应用自己去实现的，那有没有一种方案，可以让子应用不做修改呢？</p> <ol><li><p>通过 <code>nginx</code> 代理转发，根据子应用的特殊前缀，基座服务器收到之后，转发到子项目上。</p> <ul><li>这个解决方法虽然理论可行，但如果子应用比较多，情况就变得复杂起来了，所以不是很推荐。</li></ul></li> <li><p>通过自定义 <code>fetch</code> 方法，修正 <code>css</code> 中的相对地址<sup class="footnote-ref"><a href="#footnote3">[3]</a><a id="footnote-ref3" class="footnote-anchor"></a></sup><sup class="footnote-ref"><a href="#footnote4">[4]</a><a id="footnote-ref4" class="footnote-anchor"></a></sup>。</p> <ul><li>通过源码可以看到，获取 <code>css</code> 的资源，是通过 <code>fetch</code> 方法是获取的，<code>qiankun</code> 提供了自定义 <code>fetch</code> 的功能，通过自定义 <code>fetch</code> ，获取 <code>css</code> 是通过正则，将相对地址替换成正确的绝对地址，可以修正请求资源 <code>404</code> 的问题。但是这种方式只能修正通过外链形式引入的样式，通过内联方式引入的样式处理不了。同时未经过大规模的试验，可能有些边缘情况没有处理到，仅作参考。</li></ul></li></ol> <p>自定义 <code>fetch</code> 方法代码：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">fetch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> url <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">&amp;&amp;</span> url<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'.css'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> window
      <span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> resp<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">css</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> hasQuote <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\s*('|&quot;)</span><span class="token regex-delimiter">/</span></span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
          <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(@import\s+)(')(.+?)(')</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span>
          <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(@import\s+)(&quot;)(.+?)(&quot;)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span>
          <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(url\s*\()(\s*')([^']+?)(')</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span>
          <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(url\s*\()(\s*&quot;)([^&quot;]+?)(&quot;)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span>
          <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(url\s*\()(\s*)([^\s'&quot;)].*?)(\s*\))</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span>
        <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">css<span class="token punctuation">,</span> reg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> css<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>reg<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">all<span class="token punctuation">,</span> lead<span class="token punctuation">,</span> quote1<span class="token punctuation">,</span> path<span class="token punctuation">,</span> quote2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> ret
            <span class="token keyword">if</span> <span class="token punctuation">(</span>
              path<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'data:'</span><span class="token punctuation">)</span> <span class="token operator">||</span>
              path<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span> <span class="token operator">||</span>
              path<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'ftp'</span><span class="token punctuation">)</span> <span class="token operator">||</span>
              path<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'//'</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token comment">// base64、cdn的资源不处理</span>
              ret <span class="token operator">=</span> path
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
              ret <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>hasQuote<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> hasQuote<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>quote1<span class="token punctuation">)</span><span class="token punctuation">)</span> quote1 <span class="token operator">=</span> quote2 <span class="token operator">=</span> <span class="token string">''</span>
            <span class="token keyword">return</span> lead <span class="token operator">+</span> quote1 <span class="token operator">+</span> ret <span class="token operator">+</span> quote2
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> css<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">css</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token function-variable function">text</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> css <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> window<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><hr class="footnotes-sep"> <section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p><a href="https://qiankun.umijs.org/zh/faq#%E5%BE%AE%E5%BA%94%E7%94%A8%E6%89%93%E5%8C%85%E4%B9%8B%E5%90%8E-css-%E4%B8%AD%E7%9A%84%E5%AD%97%E4%BD%93%E6%96%87%E4%BB%B6%E5%92%8C%E5%9B%BE%E7%89%87%E5%8A%A0%E8%BD%BD-404" target="_blank" rel="noopener noreferrer">微应用打包之后 css 中的字体文件和图片加载 404<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="#footnote-ref1" class="footnote-backref">↩︎</a> <a href="#footnote-ref1:1" class="footnote-backref">↩︎</a></p></li> <li id="footnote2" class="footnote-item"><p>源码位置 <a href="https://github.com/kuitos/import-html-entry/blob/v1.12.0/src/index.js#L38" target="_blank" rel="noopener noreferrer">github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://gitee.com/mirrors_kuitos/import-html-entry/blob/v1.12.0/src/index.js#L38" target="_blank" rel="noopener noreferrer">gitee<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="#footnote-ref2" class="footnote-backref">↩︎</a></p></li> <li id="footnote3" class="footnote-item"><p><a href="https://github.com/umijs/qiankun/issues/981" target="_blank" rel="noopener noreferrer">希望提供可后处理 css 资源的参数，类似 getTemplate 参数可处理 html 模板<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="#footnote-ref3" class="footnote-backref">↩︎</a></p></li> <li id="footnote4" class="footnote-item"><p><a href="https://github.com/umijs/qiankun/issues/981" target="_blank" rel="noopener noreferrer">支持把微应用 css 内的 url 地址转换为完整的(cdn)链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="#footnote-ref4" class="footnote-backref">↩︎</a></p></li></ol></section></div></div> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=%E5%BE%AE%E5%89%8D%E7%AB%AF" title="标签">
      #微前端
    </a><a href="/tags/?tag=qiankun" title="标签">
      #qiankun
    </a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/01/31 19:48:05</span></div></div> <div><div class="custom-block tip" style="font-size: 13px;"><p>本博客所有文章除特别声明外，均采用
      <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="noopener norefferrer">CC BY-SA 4.0 协议</a> ，
      转载请注明出处！
    </p></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/web/vue-router-dynamic-base-solution/">
          Vue路由动态base方案
        </a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:gustinlau@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/gustinlau" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> <div>
    Copyright © 2022-2023
    <span>Gustin Lau</span></div> <div>
    Powered by
    <a href="https://github.com/vuejs/vuepress" target="_blank" title="博客系统">
      VuePress
    </a>
    &amp;
    Theme by
    <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">
      Vdoing
    </a></div></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li></ul></div></div> <!----></div><div class="global-ui"></div></div>
<script src="/assets/js/app.5600cbc3.js" defer></script><script src="/assets/js/2.e08c09ee.js" defer></script><script src="/assets/js/3.b14da0d3.js" defer></script><script src="/assets/js/10.4bfb545f.js" defer></script>
</body>
</html>
